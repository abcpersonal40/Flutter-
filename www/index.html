<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Titan Pro Console</title>
    <style>
        :root { --bg: #0f172a; --card: rgba(30, 41, 59, 0.7); --accent: #10b981; --red: #f43f5e; --blue: #3b82f6; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; box-sizing: border-box; }
        .card { background: var(--card); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 20px; margin-bottom: 15px; }
        h2 { font-size: 14px; text-transform: uppercase; color: #94a3b8; margin-top: 0; letter-spacing: 1px; }
        .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; background: #1e293b; margin-bottom: 10px; border: 1px solid #334155; }
        
        input { width: 100%; padding: 12px; background: rgba(0,0,0,0.2); border: 1px solid #334155; color: white; border-radius: 8px; margin-bottom: 10px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { border: none; padding: 14px; border-radius: 10px; color: white; font-weight: bold; font-size: 13px; cursor: pointer; transition: 0.2s; background: #334155; }
        button:active { transform: scale(0.95); }
        .btn-green { background: var(--accent); color: #000; }
        .btn-red { background: var(--red); }
        .btn-blue { background: var(--blue); }

        #log { font-family: monospace; font-size: 11px; height: 80px; overflow-y: auto; background: black; padding: 10px; border-radius: 8px; color: #00ff00; }
    </style>
</head>
<body>

    <div class="card">
        <h2>System Status</h2>
        <div id="status" class="status">BRIDGE READY</div>
        <div id="log">Logs: App Started...</div>
    </div>

    <!-- FOREGROUND SERVICE WITH DYNAMIC BUTTONS -->
    <div class="card">
        <h2>1. Dynamic Foreground Service</h2>
        <div class="grid">
            <button class="btn-green" onclick="startSvc()">START (3 BUTTONS)</button>
            <button class="btn-red" onclick="stopSvc()">STOP SERVICE</button>
        </div>
        <button style="width: 100%; margin-top:10px;" onclick="updateSvc()">UPDATE NOTIFICATION TEXT</button>
    </div>

    <!-- ALARM WITH NATIVE SOUND -->
    <div class="card">
        <h2>2. Advanced Alarm (Full Sound)</h2>
        <input type="number" id="alarmSec" value="5" placeholder="Seconds to wait">
        <button class="btn-blue" style="width: 100%;" onclick="setAlarm()">SET LOUD ALARM</button>
    </div>

    <!-- STORAGE & HAPTIC -->
    <div class="card">
        <h2>3. Storage & Haptic</h2>
        <input type="text" id="storeData" placeholder="Data to save natively">
        <div class="grid">
            <button onclick="saveNative()">SAVE DATA</button>
            <button onclick="loadNative()">LOAD DATA</button>
        </div>
        <button style="width: 100%; margin-top:10px;" onclick="vibrate()">TEST VIBRATION</button>
    </div>

    <script>
        // --- NATIVE BRIDGE ---
        const app = {
            send: (type, data = {}) => {
                if (window.TitanBridge) {
                    window.TitanBridge.postMessage(JSON.stringify({ type, ...data }));
                }
            },
            log: (msg) => {
                const l = document.getElementById('log');
                l.innerHTML += `<br>> ${msg}`;
                l.scrollTop = l.scrollHeight;
            }
        };

        // 1. Foreground Logic
        function startSvc() {
            app.send('foreground_start', {
                title: 'Titan Dynamic System',
                body: 'Market Monitoring Active',
                buttons: [
                    { id: 'btn_play', text: 'PLAY' },
                    { id: 'btn_pause', text: 'PAUSE' },
                    { id: 'btn_stop', text: 'STOP' }
                ]
            });
            app.log("Foreground Service Started with 3 buttons");
        }

        function stopSvc() {
            app.send('foreground_stop');
            app.log("Service Stopped");
        }

        function updateSvc() {
            app.send('foreground_update', {
                title: 'BTC: $69,420',
                body: 'Status: Trend High | ' + new Date().toLocaleTimeString()
            });
        }

        // 2. Alarm Logic
        function setAlarm() {
            const sec = parseInt(document.getElementById('alarmSec').value);
            app.send('alarm', { sec: sec, msg: "üö® ALERT: TIME'S UP!" });
            app.log(`Alarm scheduled in ${sec} seconds`);
        }

        // 3. Storage Logic
        function saveNative() {
            const val = document.getElementById('storeData').value;
            app.send('storage_save', { key: 'titan_key', val: val });
            app.log("Saved to Native Storage");
        }

        function loadNative() {
            app.send('storage_load', { key: 'titan_key' });
        }

        function vibrate() {
            app.send('vibrate');
            app.log("Vibration Triggered");
        }

        // --- CALLBACKS FROM NATIVE ---
        //‡¶¨‡¶æ‡¶ü‡¶® ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶≤‡¶ø‡¶Ç
        window.onNotificationClick = function(buttonId) {
            app.log(`NOTIF CLICK: ${buttonId}`);
            if (buttonId === 'btn_stop') stopSvc();
            if (buttonId === 'btn_play') app.log("Play Logic Triggered!");
        };

        //‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶°‡¶æ‡¶ü‡¶æ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶≤‡¶ø‡¶Ç
        window.fromNative = function(type, data) {
            if (type === 'storage_result') {
                document.getElementById('storeData').value = data.val;
                app.log("Loaded: " + data.val);
            }
        };
    </script>
</body>
</html>
